

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>discrete1.tools module &mdash; discrete1 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />


      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=01f34227"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="discrete1.vhybrid1d module" href="discrete1.vhybrid1d.html" />
    <link rel="prev" title="discrete1.timed1d module" href="discrete1.timed1d.html" />
</head>

<body class="wy-body-for-nav">
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >



          <a href="index.html" class="icon icon-home">
            discrete1
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="discrete1.html">discrete1 package</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="discrete1.html#subpackages">Subpackages</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="discrete1.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="discrete1.boundary1d.html">discrete1.boundary1d module</a></li>
<li class="toctree-l3"><a class="reference internal" href="discrete1.constants.html">discrete1.constants module</a></li>
<li class="toctree-l3"><a class="reference internal" href="discrete1.critical0d.html">discrete1.critical0d module</a></li>
<li class="toctree-l3"><a class="reference internal" href="discrete1.critical1d.html">discrete1.critical1d module</a></li>
<li class="toctree-l3"><a class="reference internal" href="discrete1.djinn1d.html">discrete1.djinn1d module</a></li>
<li class="toctree-l3"><a class="reference internal" href="discrete1.external1d.html">discrete1.external1d module</a></li>
<li class="toctree-l3"><a class="reference internal" href="discrete1.fixed1d.html">discrete1.fixed1d module</a></li>
<li class="toctree-l3"><a class="reference internal" href="discrete1.hybrid1d.html">discrete1.hybrid1d module</a></li>
<li class="toctree-l3"><a class="reference internal" href="discrete1.main.html">discrete1.main module</a></li>
<li class="toctree-l3"><a class="reference internal" href="discrete1.materials.html">discrete1.materials module</a></li>
<li class="toctree-l3"><a class="reference internal" href="discrete1.multi_group.html">discrete1.multi_group module</a></li>
<li class="toctree-l3"><a class="reference internal" href="discrete1.multi_group_0d.html">discrete1.multi_group_0d module</a></li>
<li class="toctree-l3"><a class="reference internal" href="discrete1.spatial_sweep.html">discrete1.spatial_sweep module</a></li>
<li class="toctree-l3"><a class="reference internal" href="discrete1.timed1d.html">discrete1.timed1d module</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">discrete1.tools module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#discrete1.tools.dmd"><code class="docutils literal notranslate"><span class="pre">dmd()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#discrete1.tools.reaction_rates"><code class="docutils literal notranslate"><span class="pre">reaction_rates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#discrete1.tools.reflector_corrector"><code class="docutils literal notranslate"><span class="pre">reflector_corrector()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="discrete1.vhybrid1d.html">discrete1.vhybrid1d module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="discrete1.html#module-discrete1">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">discrete1</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="discrete1.html">discrete1 package</a></li>
      <li class="breadcrumb-item active">discrete1.tools module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/discrete1.tools.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">

  <section id="module-discrete1.tools">
<span id="discrete1-tools-module"></span><h1>discrete1.tools module<a class="headerlink" href="#module-discrete1.tools" title="Link to this heading"></a></h1>
<p>Utility routines used across the solver package.</p>
<p>This module contains small helpers and performance-critical kernels
used by the transport drivers. It includes multigroup helpers for
assembling off-diagonal scatter sources, hybrid coarsening utilities,
0D (spatially independent) variants of source and keff updates, and
display/diagnostic helpers such as reaction rate computation. Where
appropriate, functions are implemented as Numba-jitted kernels for
performance.</p>
<p>Public helpers:
- reflector_corrector: manage reflective boundary bookkeeping
- dmd: Dynamic Mode Decomposition extrapolation
- reaction_rates: compute per-cell reaction rates</p>
<p>Numba-decorated internal kernels (prefixed with <cite>_</cite>) implement the
heavy numerical work and are not part of the high-level public API.</p>
<dl class="py function">
<dt class="sig sig-object py" id="discrete1.tools.dmd">
<span class="sig-prename descclassname"><span class="pre">discrete1.tools.</span></span><span class="sig-name descname"><span class="pre">dmd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_minus</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_plus</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/discrete1/tools.html#dmd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#discrete1.tools.dmd" title="Link to this definition"></a></dt>
<dd><p>Estimate flux via Dynamic Mode Decomposition (DMD) extrapolation.</p>
<p>Given snapshot differences (y_minus, y_plus) collected over K-1
timesteps/iterations, compute a low-rank DMD model and use it to
extrapolate the flux from the last known iterate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flux_old</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – Last known flux (n_cells, n_groups).</p></li>
<li><p><strong>y_minus</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – Snapshot difference array with shape (n_cells, n_groups, K-1)
containing previous (backward) differences.</p></li>
<li><p><strong>y_plus</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – Snapshot difference array with shape (n_cells, n_groups, K-1)
containing forward differences.</p></li>
<li><p><strong>K</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of snapshots (including the base) used for DMD.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Extrapolated flux array with shape (n_cells, n_groups).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="discrete1.tools.reaction_rates">
<span class="sig-prename descclassname"><span class="pre">discrete1.tools.</span></span><span class="sig-name descname"><span class="pre">reaction_rates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xs_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">medium_map</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/discrete1/tools.html#reaction_rates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#discrete1.tools.reaction_rates" title="Link to this definition"></a></dt>
<dd><p>Compute per-cell reaction rates from flux and cross sections.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flux</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – Scalar or angular-integrated flux with shape (n_cells, n_groups).</p></li>
<li><p><strong>xs_matrix</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – Cross-section matrix indexed by material (n_materials, n_groups, …)
where the last axes align with group dimensions.</p></li>
<li><p><strong>medium_map</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>) – Material index per spatial cell (n_cells,).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Reaction rate per cell and per group with shape (n_cells, n_groups).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="discrete1.tools.reflector_corrector">
<span class="sig-prename descclassname"><span class="pre">discrete1.tools.</span></span><span class="sig-name descname"><span class="pre">reflector_corrector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reflector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc_x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/discrete1/tools.html#reflector_corrector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#discrete1.tools.reflector_corrector" title="Link to this definition"></a></dt>
<dd><p>Apply reflector boundary correction for a paired angle.</p>
<p>When reflective boundary conditions are active, the outgoing edge
flux for one discrete ordinate is used to set the corresponding
reflected ordinate’s incoming reflector buffer. This helper writes
the edge value into the reflector array at the symmetric angle
index when reflection flags are set in <code class="docutils literal notranslate"><span class="pre">bc_x</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reflector</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – Array storing reflected edge values for each angle (n_angles,).</p></li>
<li><p><strong>angle_x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>) – Angular ordinates (n_angles,).</p></li>
<li><p><strong>edge</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Computed outgoing edge flux for the current angle.</p></li>
<li><p><strong>nn</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Current angle index.</p></li>
<li><p><strong>bc_x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">sequence</span></code>) – Boundary condition flags for left/right reflections.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="discrete1.timed1d.html" class="btn btn-neutral float-left" title="discrete1.timed1d module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="discrete1.vhybrid1d.html" class="btn btn-neutral float-right" title="discrete1.vhybrid1d module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Ben Whewell.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

</body>
</html>
